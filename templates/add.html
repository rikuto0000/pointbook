<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å®šç‚¹è¿½åŠ  | VALORANT Pointbook</title>

  <!-- âœ… PWAå¯¾å¿œ -->
  <link rel="manifest" href="/static/manifest.json">
  <meta name="theme-color" content="#ff4655">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="Pointbook">
  <link rel="apple-touch-icon" href="/static/icons/icon-192.png">

  <!-- âœ… Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/static/service-worker.js')
        .then(reg => console.log("âœ… Service Worker registered"))
        .catch(err => console.error("âŒ Service Worker error:", err));
    }
  </script>

  <!-- âœ… Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- âœ… Rajdhani Font -->
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;700&display=swap" rel="stylesheet">

  <!-- âœ… Modern Styles -->
  <link rel="stylesheet" href="/static/css/modern.css">

  <!-- âœ… Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

  <!-- Fallback styles -->
  {% include 'base_styles.html' %}
</head>

<body>
  <!-- Animated Background Particles -->
  <div class="particles">
    {% for i in range(6) %}
    <div class="particle" style="left: {{ (i * 15 + 10) }}%; animation-delay: {{ i * 0.8 }}s;"></div>
    {% endfor %}
  </div>

  <!-- Navigation -->
  <nav class="p-4" style="animation: slideInLeft 0.6s ease-out;">
    <a href="/" class="inline-flex items-center gap-2 text-gray-300 hover:text-white transition-colors duration-300">
      <i class="fas fa-home"></i>
      <span>ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</span>
    </a>
  </nav>

  <!-- Header -->
  <header class="glass rounded-2xl mx-4 mb-8 p-8 text-center" style="animation: fadeInUp 0.8s ease-out;">
    <div class="flex items-center justify-center gap-4 mb-6">
      <i class="fas fa-plus-circle text-3xl text-glow"></i>
      <h1 class="text-4xl sm:text-5xl font-bold text-glow tracking-wide">
        æ–°ã—ã„å®šç‚¹ã‚’è¿½åŠ 
      </h1>
    </div>
    <p class="text-xl text-gray-300 font-medium tracking-wider">ã‚ãªãŸã®ãƒ©ã‚¤ãƒ³ãƒŠãƒƒãƒ—ã‚’å…±æœ‰ã—ã¾ã—ã‚‡ã†</p>
    <div class="w-32 h-1 bg-gradient-to-r from-purple-500 via-red-500 to-yellow-500 mx-auto mt-4 rounded"></div>
  </header>

  <!-- Main Form -->
  <main class="container mx-auto px-4 pb-8">
    <div class="max-w-2xl mx-auto">
      
      <form action="/add" method="POST" enctype="multipart/form-data" 
            class="glass rounded-2xl p-8 space-y-6" style="animation: fadeInUp 0.8s ease-out 0.2s both;">
        
        <!-- Basic Info Section -->
        <section class="space-y-6">
          <h2 class="text-2xl font-bold text-white flex items-center gap-3">
            <i class="fas fa-info-circle text-blue-400"></i>
            åŸºæœ¬æƒ…å ±
          </h2>
          
          <!-- Title -->
          <div class="form-group">
            <label class="form-label">
              <i class="fas fa-tag text-purple-400"></i>
              ã‚¿ã‚¤ãƒˆãƒ«
            </label>
            <input type="text" name="title" placeholder="ä¾‹: MIDãƒªã‚³ãƒ³å®šç‚¹" required
                   class="form-input" />
          </div>

          <!-- Description -->
          <div class="form-group">
            <label class="form-label">
              <i class="fas fa-align-left text-green-400"></i>
              èª¬æ˜
            </label>
            <textarea name="description" placeholder="ä¾‹: 1ãƒã‚¦ãƒ³ã‚¹ãƒ•ãƒ«ãƒãƒ£ãƒ¼ã‚¸ã§MIDã‚’ç´¢æ•µ" required
                      class="form-input min-h-[80px] resize-vertical"></textarea>
          </div>
        </section>

        <!-- Map & Agent Section -->
        <section class="space-y-6">
          <h2 class="text-2xl font-bold text-white flex items-center gap-3">
            <i class="fas fa-map text-red-400"></i>
            ãƒãƒƒãƒ—ãƒ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè¨­å®š
          </h2>
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Map -->
            <div class="form-group">
              <label class="form-label">
                <i class="fas fa-globe text-blue-400"></i>
                ãƒãƒƒãƒ—
              </label>
              <select name="map" required class="form-select">
                <option value="">ãƒãƒƒãƒ—ã‚’é¸æŠ</option>
                <option value="ascent">ğŸ›ï¸ ã‚¢ã‚»ãƒ³ãƒˆ</option>
                <option value="split">ğŸ™ï¸ ã‚¹ãƒ—ãƒªãƒƒãƒˆ</option>
                <option value="bind">ğŸœï¸ ãƒã‚¤ãƒ³ãƒ‰</option>
                <option value="haven">ğŸŒ¸ ãƒ˜ã‚¤ãƒ–ãƒ³</option>
                <option value="icebox">â„ï¸ ã‚¢ã‚¤ã‚¹ãƒœãƒƒã‚¯ã‚¹</option>
                <option value="breeze">ğŸï¸ ãƒ–ãƒªãƒ¼ã‚º</option>
                <option value="fracture">âš¡ ãƒ•ãƒ©ã‚¯ãƒãƒ£ãƒ¼</option>
                <option value="pearl">ğŸŒŠ ãƒ‘ãƒ¼ãƒ«</option>
                <option value="lotus">ğŸª· ãƒ­ãƒ¼ã‚¿ã‚¹</option>
                <option value="sunset">ğŸŒ… ã‚µãƒ³ã‚»ãƒƒãƒˆ</option>
              </select>
            </div>

            <!-- Side -->
            <div class="form-group">
              <label class="form-label">
                <i class="fas fa-sword text-red-400"></i>
                ã‚µã‚¤ãƒ‰
              </label>
              <select name="side" required class="form-select">
                <option value="">ã‚µã‚¤ãƒ‰ã‚’é¸æŠ</option>
                <option value="attack">âš”ï¸ æ”»æ’ƒ</option>
                <option value="defense">ğŸ›¡ï¸ é˜²è¡›</option>
              </select>
            </div>
          </div>

          <!-- Agent -->
          <div class="form-group">
            <label class="form-label">
              <i class="fas fa-user-ninja text-purple-400"></i>
              ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
            </label>
            <select name="agent" required class="form-select">
              <option value="">ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’é¸æŠ</option>
              <optgroup label="ğŸŒªï¸ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼">
                <option value="brimstone">ãƒ–ãƒªãƒ ã‚¹ãƒˆãƒ¼ãƒ³</option>
                <option value="viper">ãƒ´ã‚¡ã‚¤ãƒ‘ãƒ¼</option>
                <option value="omen">ã‚ªãƒ¼ãƒ¡ãƒ³</option>
                <option value="astra">ã‚¢ã‚¹ãƒˆãƒ©</option>
                <option value="harbor">ãƒãƒ¼ãƒãƒ¼</option>
                <option value="clove">ã‚¯ãƒ­ãƒ¼ãƒ´</option>
              </optgroup>
              <optgroup label="ğŸ‘ï¸ ã‚¤ãƒ‹ã‚·ã‚¨ãƒ¼ã‚¿ãƒ¼">
                <option value="sova">ã‚½ãƒ¼ãƒ´ã‚¡</option>
                <option value="breach">ãƒ–ãƒªãƒ¼ãƒ</option>
                <option value="skye">ã‚¹ã‚«ã‚¤</option>
                <option value="kayo">KAY/O</option>
                <option value="fade">ãƒ•ã‚§ã‚¤ãƒ‰</option>
                <option value="gekko">ã‚²ãƒƒã‚³ãƒ¼</option>
              </optgroup>
              <optgroup label="ğŸ›¡ï¸ ã‚»ãƒ³ãƒãƒãƒ«">
                <option value="sage">ã‚»ãƒ¼ã‚¸</option>
                <option value="cypher">ã‚µã‚¤ãƒ•ã‚¡ãƒ¼</option>
                <option value="killjoy">ã‚­ãƒ«ã‚¸ãƒ§ã‚¤</option>
                <option value="chamber">ãƒã‚§ãƒ³ãƒãƒ¼</option>
                <option value="deadlock">ãƒ‡ãƒƒãƒ‰ãƒ­ãƒƒã‚¯</option>
                <option value="vyse">ãƒ´ã‚¡ã‚¤ã‚¹</option>
              </optgroup>
              <optgroup label="âš¡ ãƒ‡ãƒ¥ã‚¨ãƒªã‚¹ãƒˆ">
                <option value="phoenix">ãƒ•ã‚§ãƒ‹ãƒƒã‚¯ã‚¹</option>
                <option value="reyna">ãƒ¬ã‚¤ãƒŠ</option>
                <option value="jett">ã‚¸ã‚§ãƒƒãƒˆ</option>
                <option value="raze">ãƒ¬ã‚¤ã‚º</option>
                <option value="yoru">ãƒ¨ãƒ«</option>
                <option value="neon">ãƒã‚ªãƒ³</option>
                <option value="iso">ã‚¢ã‚¤ã‚½</option>
              </optgroup>
            </select>
          </div>
        </section>

        <!-- Images Section -->
        <section class="space-y-6">
          <h2 class="text-2xl font-bold text-white flex items-center gap-3">
            <i class="fas fa-images text-yellow-400"></i>
            ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
          </h2>
          
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <!-- Stand Image -->
            <div class="form-group">
              <label class="form-label">
                <i class="fas fa-map-marker-alt text-blue-400"></i>
                ç«‹ã¡ä½ç½®ç”»åƒ
              </label>
              <div class="file-upload-wrapper">
                <input type="file" name="stand_image" accept="image/*" required 
                       class="file-input" id="stand_image" />
                <label for="stand_image" class="file-upload-label">
                  <i class="fas fa-cloud-upload-alt text-2xl mb-2"></i>
                  <span>ç«‹ã¡ä½ç½®ã‚’é¸æŠ</span>
                  <small>ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç”»åƒã‚’é¸æŠ</small>
                </label>
              </div>
            </div>

            <!-- Point Image -->
            <div class="form-group">
              <label class="form-label">
                <i class="fas fa-crosshairs text-red-400"></i>
                ã‚¨ã‚¤ãƒ ãƒã‚¤ãƒ³ãƒˆç”»åƒ
              </label>
              <div class="file-upload-wrapper">
                <input type="file" name="point_image" accept="image/*" required 
                       class="file-input" id="point_image" />
                <label for="point_image" class="file-upload-label">
                  <i class="fas fa-cloud-upload-alt text-2xl mb-2"></i>
                  <span>ã‚¨ã‚¤ãƒ ãƒã‚¤ãƒ³ãƒˆã‚’é¸æŠ</span>
                  <small>ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç”»åƒã‚’é¸æŠ</small>
                </label>
              </div>
            </div>

            <!-- Extra Image -->
            <div class="form-group">
              <label class="form-label">
                <i class="fas fa-bullseye text-green-400"></i>
                ç€å¼¾ä½ç½®ç”»åƒ
              </label>
              <div class="file-upload-wrapper">
                <input type="file" name="extra_image" accept="image/*" required 
                       class="file-input" id="extra_image" />
                <label for="extra_image" class="file-upload-label">
                  <i class="fas fa-cloud-upload-alt text-2xl mb-2"></i>
                  <span>ç€å¼¾ä½ç½®ã‚’é¸æŠ</span>
                  <small>ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç”»åƒã‚’é¸æŠ</small>
                </label>
              </div>
            </div>
          </div>
        </section>

        <!-- Submit Section -->
        <section class="pt-6 border-t border-gray-600">
          <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <a href="/" class="btn-secondary inline-flex items-center justify-center gap-2">
              <i class="fas fa-arrow-left"></i>
              <span>ã‚­ãƒ£ãƒ³ã‚»ãƒ«</span>
            </a>
            
            <button type="submit" class="btn-primary inline-flex items-center justify-center gap-2" id="submit-btn">
              <i class="fas fa-plus"></i>
              <span>å®šç‚¹ã‚’ç™»éŒ²</span>
            </button>
          </div>
        </section>

      </form>

      <!-- Tips Section -->
      <div class="glass rounded-2xl p-6 mt-8" style="animation: fadeInUp 0.8s ease-out 0.4s both;">
        <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
          <i class="fas fa-lightbulb text-yellow-400"></i>
          æŠ•ç¨¿ã®ã‚³ãƒ„
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-300">
          <div class="flex items-start gap-2">
            <i class="fas fa-camera text-blue-400 mt-1"></i>
            <div>
              <strong>ç«‹ã¡ä½ç½®:</strong> ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒè¦‹ãˆã‚‹ä½ç½®ã§æ’®å½±
            </div>
          </div>
          <div class="flex items-start gap-2">
            <i class="fas fa-target text-red-400 mt-1"></i>
            <div>
              <strong>ã‚¨ã‚¤ãƒ :</strong> ã‚¯ãƒ­ã‚¹ãƒ˜ã‚¢ã®ä½ç½®ãŒåˆ†ã‹ã‚‹ã‚ˆã†ã«
            </div>
          </div>
          <div class="flex items-start gap-2">
            <i class="fas fa-map-pin text-green-400 mt-1"></i>
            <div>
              <strong>ç€å¼¾:</strong> ã‚¹ã‚­ãƒ«ã®åŠ¹æœç¯„å›²ã‚’ç¤ºã™
            </div>
          </div>
        </div>
      </div>

    </div>
  </main>

  <script>
    // Enhanced form interactions
    document.addEventListener('DOMContentLoaded', function() {
      try {
        // File upload preview
        const fileInputs = document.querySelectorAll('.file-input');
        fileInputs.forEach(input => {
          input.addEventListener('change', function(e) {
            try {
              const file = e.target.files[0];
              const label = document.querySelector(`label[for="${this.id}"]`);
              
              if (file && label) {
                const fileName = file.name.length > 20 ? 
                  file.name.substring(0, 20) + '...' : file.name;
                label.querySelector('span').textContent = fileName;
                label.classList.add('file-selected');
              }
            } catch (err) {
              console.warn('File preview error:', err);
            }
          });
        });

        // Form submission enhancement
        const form = document.querySelector('form');
        const submitBtn = document.getElementById('submit-btn');
        
        if (form && submitBtn) {
          form.addEventListener('submit', function(e) {
            try {
              submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i><span>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...</span>';
              submitBtn.disabled = true;
              
              // Show upload progress (visual feedback)
              const loadingOverlay = document.createElement('div');
              loadingOverlay.className = 'fixed inset-0 bg-black/50 flex items-center justify-center z-50';
              loadingOverlay.innerHTML = `
                <div class="glass rounded-2xl p-8 text-center">
                  <div class="loading w-12 h-12 border-4 border-white border-t-transparent rounded-full mx-auto mb-4"></div>
                  <p class="text-white text-lg">å®šç‚¹ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...</p>
                  <p class="text-gray-300 text-sm mt-2">ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„</p>
                </div>
              `;
              document.body.appendChild(loadingOverlay);
            } catch (err) {
              console.warn('Submit enhancement error:', err);
            }
          });
        }

        // Parallax effect for particles
        document.addEventListener('mousemove', function(e) {
          try {
            const particles = document.querySelectorAll('.particle');
            if (particles.length > 0) {
              const mouseX = e.clientX / window.innerWidth;
              const mouseY = e.clientY / window.innerHeight;

              particles.forEach((particle, index) => {
                const speed = (index + 1) * 0.3;
                const x = mouseX * speed * 10;
                const y = mouseY * speed * 10;
                if (particle && particle.style) {
                  particle.style.transform = `translateX(${x}px) translateY(${y}px)`;
                }
              });
            }
          } catch (err) {
            console.warn('Parallax error:', err);
          }
        });

      } catch (err) {
        console.error('Script initialization error:', err);
      }
    });

    // Global error handler
    window.addEventListener('error', function(e) {
      console.error('Global error:', e.error);
    });
  </script>
</body>
</html>